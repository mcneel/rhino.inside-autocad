export const metadata = {
  title: 'Layers - Rhino.Inside.AutoCAD',
  description: 'Components for working with AutoCAD layers',
}

# Layers

Components for managing AutoCAD layers. Retrieve, create, and modify layers to organize geometry in your AutoCAD drawings.

```csharp
// Namespace: Rhino.Inside.AutoCAD.GrasshopperLibrary
using Autodesk.AutoCAD.DatabaseServices;
using Rhino.Inside.AutoCAD.Interop;
using CadLayer = Autodesk.AutoCAD.DatabaseServices.LayerTableRecord;
```

---

## GetAutocadLayersComponent {{ tag: 'List<Layer>', label: 'Layers' }}

<Row>
  <Col>
    Returns all layers in the AutoCAD document.

    ### Parameters
    - `Document` (AutocadDocument): An AutoCAD Document

    ### Returns
    - `Layers` (List&lt;AutocadLayerTableRecordWrapper&gt;): All layers in the document

    ### Remarks
    Implements `IReferenceComponent` - automatically updates when layers are added, removed, or modified in AutoCAD.
  </Col>
  <Col sticky>
    ```csharp
    // Example: List all layers
    using Autodesk.AutoCAD.DatabaseServices;

    // GetAutocadDocuments [ActiveDoc]
    //     → Get AutoCAD Layers [Layers]
    //         → AutoCAD Layer [Name]
    //             → Panel (list all layer names)

    // Filter visible layers:
    // Get AutoCAD Layers [Layers]
    //     → AutoCAD Layer [each]
    //         → Filter [IsOff = false]
    //         → Filter [IsFrozen = false]
    ```
  </Col>
</Row>

---

## AutocadLayerComponent {{ tag: 'Properties', label: 'Layers' }}

<Row>
  <Col>
    Gets information from an AutoCAD Layer.

    ### Parameters
    - `Layer` (AutocadLayerTableRecordWrapper): An AutoCAD Layer

    ### Returns
    - `Name` (String): The name of the layer
    - `Id` (AutocadObjectId): The ObjectId of the layer
    - `LinePatternId` (AutocadObjectId): The ObjectId of the layer's line pattern
    - `Colour` (System.Drawing.Color): The color associated with the layer
    - `Locked` (Boolean): Whether the layer is locked
  </Col>
  <Col sticky>
    ```csharp
    // Example: Get layer properties for report
    using System.Drawing;

    // Get AutoCAD Layers [Layers]
    //     → AutoCAD Layer
    //         → [Name]: "A-WALL"
    //         → [Colour]: Color.Red
    //         → [Locked]: false

    // Create layer schedule:
    // Layers → AutoCAD Layer [Name, Colour]
    //        → Data Table component
    ```
  </Col>
</Row>

---

## CreateAutocadLayerComponent {{ tag: 'Layer', label: 'Layers' }}

<Row>
  <Col>
    Creates a new AutoCAD Layer in the document.

    ### Parameters
    - `Document` (AutocadDocument): An AutoCAD Document
    - `NewName` (String): The name for the new layer
    - `NewColour` (System.Drawing.Color): The color for the layer (default: White)

    ### Returns
    - `Name` (String): The name of the created layer
    - `Id` (AutocadObjectId): The ObjectId of the created layer
    - `LinePatternId` (AutocadObjectId): The ObjectId of the layer's line pattern
    - `Colour` (System.Drawing.Color): The color of the layer
    - `Locked` (Boolean): Whether the layer is locked

    ### Exceptions
    - Error: "Unable to create layer" - Layer name invalid or creation failed
  </Col>
  <Col sticky>
    ```csharp
    // Example: Create construction layer
    using System.Drawing;

    // Create AutoCAD Layer
    //     → [Document]: ActiveDoc
    //     → [NewName]: "A-WALL-DEMO"
    //     → [NewColour]: Color.Yellow

    // Layer naming conventions (AIA):
    // A-WALL      - Architectural walls
    // A-DOOR      - Doors
    // A-GLAZ      - Glazing
    // S-COLS      - Structural columns
    // M-DUCT      - Mechanical ductwork

    // Create multiple layers:
    // Panel [layer names list]
    //     → Create AutoCAD Layer (for each)
    ```
  </Col>
</Row>

---

## GetAutocadLayerByNameComponent {{ tag: 'Layer', label: 'Layers' }}

<Row>
  <Col>
    Retrieves an AutoCAD Layer by its name.

    ### Parameters
    - `Document` (AutocadDocument): An AutoCAD Document
    - `Name` (String): The name of the layer to find

    ### Returns
    - `Layer` (AutocadLayerTableRecordWrapper): The found layer, or null if not found
  </Col>
  <Col sticky>
    ```csharp
    // Example: Get layer for baking
    //
    // Get Layer By Name
    //     → [Document]: ActiveDoc
    //     → [Name]: "A-WALL"
    //     → [Layer]
    //         → Bake Settings [Layer]
    //             → Bake to AutoCAD

    // Create if not exists pattern:
    // Get Layer By Name [Layer]
    //     → Gate (if null)
    //         → Create AutoCAD Layer
    ```
  </Col>
</Row>

---

## SetAutocadLayerComponent {{ tag: 'Layer', label: 'Layers' }}

<Row>
  <Col>
    Modifies properties of an existing AutoCAD Layer.

    ### Parameters
    - `Layer` (AutocadLayerTableRecordWrapper): An AutoCAD Layer to modify
    - `Name` (String): New name for the layer (optional)
    - `Colour` (System.Drawing.Color): New color for the layer (optional)
    - `Locked` (Boolean): Lock state for the layer (optional)

    ### Returns
    - `Layer` (AutocadLayerTableRecordWrapper): The modified layer
  </Col>
  <Col sticky>
    ```csharp
    // Example: Lock all "XREF" layers
    using System.Drawing;

    // Get AutoCAD Layers [Layers]
    //     → Filter [Name contains "XREF"]
    //         → Set AutoCAD Layer
    //             → [Locked]: true

    // Change layer color:
    // Get Layer By Name ["A-WALL"]
    //     → Set AutoCAD Layer
    //         → [Colour]: Color.Blue
    ```
  </Col>
</Row>

---

## Layer Workflow Patterns

### Organize Baked Geometry by Type

```csharp
// Walls  → Bake Settings [Layer: "A-WALL"] → Bake
// Doors  → Bake Settings [Layer: "A-DOOR"] → Bake
// Floors → Bake Settings [Layer: "A-FLOR"] → Bake
```

### Layer State Management

```csharp
// Freeze non-essential layers during heavy operations:
// Get Layers → Filter [Name not "A-WALL"]
//            → Set Layer [IsFrozen: true]
//
// ... perform operations ...
//
// Get Layers → Set Layer [IsFrozen: false]
```

### Create Layer Structure from Template

```csharp
// Read layer names from text file
// Panel [layer definitions]
//     → Split Text (name, color pairs)
//         → Create AutoCAD Layer (batch)
```
