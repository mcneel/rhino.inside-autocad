export const metadata = {
  title: 'Geometry Conversion - Rhino.Inside.AutoCAD',
  description: 'Components for converting geometry between Rhino and AutoCAD formats',
}

# Geometry Conversion

Components for converting geometry between Rhino and AutoCAD formats. Use "To AutoCAD" components to prepare geometry for baking, and "From AutoCAD" components to work with AutoCAD geometry in Grasshopper.

```csharp
// Namespace: Rhino.Inside.AutoCAD.GrasshopperLibrary
using Rhino.Inside.AutoCAD.Interop;
using RhinoCurve = Rhino.Geometry.Curve;
using AutocadCurve = Autodesk.AutoCAD.DatabaseServices.Curve;
```

---

## Conversion Pipeline

The typical workflow for geometry exchange:

```
┌─────────────────────────────────────────────────────────────────┐
│  RHINO → AUTOCAD (for baking)                                   │
│                                                                 │
│  Rhino Geometry → To AutoCAD Component → Bake Component → DWG  │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│  AUTOCAD → RHINO (for manipulation)                             │
│                                                                 │
│  DWG → Parameter/Query → From AutoCAD Component → Grasshopper  │
└─────────────────────────────────────────────────────────────────┘
```

---

## Curve Conversion

### ConvertToAutoCadCurveComponent {{ tag: 'List<Curve>', label: 'Convert' }}

<Row>
  <Col>
    Converts a Rhino Curve to AutoCAD curve format.

    ### Parameters
    - `Curve` (Rhino.Geometry.Curve): A Rhino Curve

    ### Returns
    - `Curve` (List&lt;Autodesk.AutoCAD.DatabaseServices.Curve&gt;): AutoCAD curve(s)

    ### Remarks
    A single Rhino curve may convert to multiple AutoCAD curves. For example, a polycurve with mixed line and arc segments may become separate Line and Arc entities.

    ### Supported Conversions
    | Rhino Type | AutoCAD Type |
    |------------|--------------|
    | LineCurve | Line |
    | ArcCurve | Arc |
    | Circle | Circle |
    | Polyline | Polyline |
    | PolyCurve | Multiple entities |
    | NurbsCurve | Spline |
    | Ellipse | Ellipse |
  </Col>
  <Col sticky>
    ```csharp
    // Example: Convert complex polycurve
    using Rhino.Geometry;
    using Autodesk.AutoCAD.DatabaseServices;

    // Rhino PolyCurve with line + arc + line
    //     → To AutoCAD Curve
    //         → [Curve]: List of 3 entities
    //             [0]: Line
    //             [1]: Arc
    //             [2]: Line

    // Workflow:
    // Circle component [Curve]
    //     → To AutoCAD Curve [Curve]
    //         → Bake to AutoCAD

    // For closed curves:
    // Rectangle → To AutoCAD Curve
    //           → Polyline (closed)

    // For NURBS:
    // Interpolate Curve → To AutoCAD Curve
    //                   → Spline
    ```
  </Col>
</Row>

---

### ConvertFromAutoCadCurveComponent {{ tag: 'Curve', label: 'Convert' }}

<Row>
  <Col>
    Converts an AutoCAD curve to Rhino Curve format.

    ### Parameters
    - `Curve` (Autodesk.AutoCAD.DatabaseServices.Curve): An AutoCAD curve

    ### Returns
    - `Curve` (Rhino.Geometry.Curve): A Rhino Curve
  </Col>
  <Col sticky>
    ```csharp
    // Example: Import AutoCAD polyline
    using Rhino.Geometry;

    // AutoCAD Curve Param (select polyline)
    //     → From AutoCAD Curve [Curve]
    //         → Explode (if needed)
    //         → Offset Curve
    //         → To AutoCAD Curve
    //         → Bake

    // Type conversions:
    // Line      → LineCurve
    // Arc       → ArcCurve
    // Circle    → ArcCurve (IsCircle=true)
    // Polyline  → PolylineCurve / PolyCurve
    // Spline    → NurbsCurve
    // Ellipse   → NurbsCurve
    ```
  </Col>
</Row>

---

## Point Conversion

### ConvertToAutoCadPointComponent {{ tag: 'DBPoint', label: 'Convert' }}

<Row>
  <Col>
    Converts a Rhino Point to AutoCAD DBPoint format.

    ### Parameters
    - `Point` (Rhino.Geometry.Point3d): A Rhino Point

    ### Returns
    - `Point` (Autodesk.AutoCAD.DatabaseServices.DBPoint): AutoCAD DBPoint
  </Col>
  <Col sticky>
    ```csharp
    // Example: Create survey points
    using Rhino.Geometry;
    using Autodesk.AutoCAD.DatabaseServices;

    // Points from file/calculation
    //     → To AutoCAD Point [Point]
    //         → Bake to AutoCAD

    // Point display in AutoCAD controlled by:
    // PDMODE - Point display style
    // PDSIZE - Point display size
    ```
  </Col>
</Row>

---

### ConvertFromAutoCadPointComponent {{ tag: 'Point3d', label: 'Convert' }}

<Row>
  <Col>
    Converts an AutoCAD DBPoint to Rhino Point format.

    ### Parameters
    - `Point` (Autodesk.AutoCAD.DatabaseServices.DBPoint): An AutoCAD DBPoint

    ### Returns
    - `Point` (Rhino.Geometry.Point3d): A Rhino Point
  </Col>
  <Col sticky>
    ```csharp
    // Example: Import AutoCAD points as Rhino points
    //
    // AutoCAD Point Param (select points)
    //     → From AutoCAD Point [Point]
    //         → Use as attractor points
    //         → Generate Voronoi
    ```
  </Col>
</Row>

---

## Mesh Conversion

### ConvertToAutoCadMeshComponent {{ tag: 'PolyFaceMesh', label: 'Convert' }}

<Row>
  <Col>
    Converts a Rhino Mesh to AutoCAD PolyFaceMesh format.

    ### Parameters
    - `Mesh` (Rhino.Geometry.Mesh): A Rhino Mesh

    ### Returns
    - `Mesh` (Autodesk.AutoCAD.DatabaseServices.PolyFaceMesh): AutoCAD PolyFaceMesh
  </Col>
  <Col sticky>
    ```csharp
    // Example: Bake terrain mesh
    using Rhino.Geometry;

    // Mesh from terrain data
    //     → To AutoCAD Mesh [Mesh]
    //         → Bake to AutoCAD

    // Mesh preparation tips:
    // - Weld vertices for clean conversion
    // - Triangulate quads if issues occur
    // - Check mesh validity before conversion
    ```
  </Col>
</Row>

---

### ConvertFromAutoCadMeshComponent {{ tag: 'Mesh', label: 'Convert' }}

<Row>
  <Col>
    Converts an AutoCAD mesh to Rhino Mesh format.

    ### Parameters
    - `Mesh` (Autodesk.AutoCAD.DatabaseServices.PolyFaceMesh): An AutoCAD mesh

    ### Returns
    - `Mesh` (Rhino.Geometry.Mesh): A Rhino Mesh
  </Col>
  <Col sticky>
    ```csharp
    // Example: Import mesh for analysis
    //
    // AutoCAD Mesh Param
    //     → From AutoCAD Mesh [Mesh]
    //         → Mesh Volume
    //         → Mesh Area
    ```
  </Col>
</Row>

---

## Solid Conversion

### ConvertToAutoCadSolidComponent {{ tag: 'Solid3d', label: 'Convert' }}

<Row>
  <Col>
    Converts a Rhino Brep to AutoCAD Solid3d format.

    ### Parameters
    - `Brep` (Rhino.Geometry.Brep): A Rhino Brep

    ### Returns
    - `Solid` (Autodesk.AutoCAD.DatabaseServices.Solid3d): AutoCAD Solid3d

    ### Remarks
    Complex Breps may convert to multiple solids. A warning is displayed if this occurs, and only the first solid is returned.
  </Col>
  <Col sticky>
    ```csharp
    // Example: Convert building mass to solid
    using Rhino.Geometry;
    using Autodesk.AutoCAD.DatabaseServices;

    // Brep from extrusion
    //     → To AutoCAD Solid [Solid]
    //         → Bake to AutoCAD

    // Brep requirements:
    // - Must be closed (solid)
    // - Valid (no naked edges)
    // - Non-self-intersecting

    // For open surfaces:
    // Surface → Cap Holes → To AutoCAD Solid
    ```
  </Col>
</Row>

---

### ConvertFromAutoCadSolidComponent {{ tag: 'Brep', label: 'Convert' }}

<Row>
  <Col>
    Converts an AutoCAD Solid3d to Rhino Brep format.

    ### Parameters
    - `Solid` (Autodesk.AutoCAD.DatabaseServices.Solid3d): An AutoCAD Solid3d

    ### Returns
    - `Brep` (Rhino.Geometry.Brep): A Rhino Brep
  </Col>
  <Col sticky>
    ```csharp
    // Example: Import solid for boolean operations
    //
    // AutoCAD Solid Param
    //     → From AutoCAD Solid [Brep]
    //         → Solid Difference (cut openings)
    //         → To AutoCAD Solid
    //         → Bake
    ```
  </Col>
</Row>

---

## Hatch Conversion

### ConvertToAutoCadHatchComponent {{ tag: 'Hatch', label: 'Convert' }}

<Row>
  <Col>
    Converts a Rhino Hatch to AutoCAD Hatch format.

    ### Parameters
    - `Hatch` (Rhino.Geometry.Hatch): A Rhino Hatch

    ### Returns
    - `Hatch` (Autodesk.AutoCAD.DatabaseServices.Hatch): AutoCAD Hatch
  </Col>
  <Col sticky>
    ```csharp
    // Example: Create floor finish hatches
    using Rhino.Geometry;

    // Boundary curves → Hatch
    //     → To AutoCAD Hatch [Hatch]
    //         → Bake to AutoCAD

    // Hatch patterns must exist in AutoCAD
    // Common patterns: SOLID, ANSI31, BRICK
    ```
  </Col>
</Row>

---

### ConvertFromAutoCadHatchComponent {{ tag: 'Hatch', label: 'Convert' }}

<Row>
  <Col>
    Converts an AutoCAD Hatch to Rhino Hatch format.

    ### Parameters
    - `Hatch` (Autodesk.AutoCAD.DatabaseServices.Hatch): An AutoCAD Hatch

    ### Returns
    - `Hatch` (Rhino.Geometry.Hatch): A Rhino Hatch
  </Col>
  <Col sticky>
    ```csharp
    // Example: Extract hatch boundaries
    //
    // AutoCAD Hatch Param
    //     → From AutoCAD Hatch [Hatch]
    //         → Explode Hatch
    //         → Get boundary curves
    ```
  </Col>
</Row>

---

## Text Conversion

### ConvertToAutoCadTextComponent {{ tag: 'MText', label: 'Convert' }}

<Row>
  <Col>
    Converts a Rhino TextEntity to AutoCAD Text format.

    ### Parameters
    - `Text` (Rhino.Geometry.TextEntity): A Rhino TextEntity

    ### Returns
    - `Text` (Autodesk.AutoCAD.DatabaseServices.MText): AutoCAD MText
  </Col>
  <Col sticky>
    ```csharp
    // Example: Add room labels
    using Rhino.Geometry;

    // Text component with room names
    //     → To AutoCAD Text [Text]
    //         → Bake to AutoCAD

    // Text properties preserved:
    // - Content string
    // - Position
    // - Height
    // - Rotation
    // - Justification
    ```
  </Col>
</Row>

---

### ConvertFromAutoCadTextComponent {{ tag: 'TextEntity', label: 'Convert' }}

<Row>
  <Col>
    Converts an AutoCAD Text to Rhino TextEntity format.

    ### Parameters
    - `Text` (Autodesk.AutoCAD.DatabaseServices.MText): An AutoCAD Text object

    ### Returns
    - `Text` (Rhino.Geometry.TextEntity): A Rhino TextEntity
  </Col>
  <Col sticky>
    ```csharp
    // Example: Extract and modify room labels
    //
    // AutoCAD Text Param
    //     → From AutoCAD Text [Text]
    //         → Deconstruct Text
    //         → Modify content
    //         → Reconstruct Text
    //         → To AutoCAD Text
    //         → Bake
    ```
  </Col>
</Row>

---

## Dimension Conversion

### ConvertToAutoCadDimensionComponent {{ tag: 'Dimension', label: 'Convert' }}

<Row>
  <Col>
    Converts a Rhino Dimension to AutoCAD Dimension format.

    ### Parameters
    - `Dimension` (Rhino.Geometry.Dimension): A Rhino Dimension

    ### Returns
    - `Dimension` (Autodesk.AutoCAD.DatabaseServices.Dimension): AutoCAD Dimension
  </Col>
  <Col sticky>
    ```csharp
    // Example: Create aligned dimensions
    using Rhino.Geometry;

    // Rhino dimension annotation
    //     → To AutoCAD Dimension [Dimension]
    //         → Bake to AutoCAD

    // Supported dimension types:
    // - Linear
    // - Aligned
    // - Angular
    // - Radial
    // - Diameter
    // - Ordinate
    ```
  </Col>
</Row>

---

### ConvertFromAutoCadDimensionComponent {{ tag: 'Dimension', label: 'Convert' }}

<Row>
  <Col>
    Converts an AutoCAD Dimension to Rhino Dimension format.

    ### Parameters
    - `Dimension` (Autodesk.AutoCAD.DatabaseServices.Dimension): An AutoCAD Dimension

    ### Returns
    - `Dimension` (Rhino.Geometry.Dimension): A Rhino Dimension
  </Col>
  <Col sticky>
    ```csharp
    // Example: Read dimension values
    //
    // AutoCAD Dimension Param
    //     → From AutoCAD Dimension [Dimension]
    //         → Deconstruct Dimension
    //         → [Measurement]: Numeric value
    ```
  </Col>
</Row>

---

## Leader Conversion

### ConvertToAutoCadLeaderComponent {{ tag: 'MLeader', label: 'Convert' }}

<Row>
  <Col>
    Converts a Rhino Leader to AutoCAD MLeader format.

    ### Parameters
    - `Leader` (Rhino.Geometry.Leader): A Rhino Leader

    ### Returns
    - `Leader` (Autodesk.AutoCAD.DatabaseServices.MLeader): AutoCAD MLeader
  </Col>
  <Col sticky>
    ```csharp
    // Example: Create annotation leaders
    using Rhino.Geometry;

    // Leader from points + text
    //     → To AutoCAD Leader [Leader]
    //         → Bake to AutoCAD
    ```
  </Col>
</Row>

---

### ConvertFromAutoCadLeaderComponent {{ tag: 'Leader', label: 'Convert' }}

<Row>
  <Col>
    Converts an AutoCAD Leader to Rhino Leader format.

    ### Parameters
    - `Leader` (Autodesk.AutoCAD.DatabaseServices.MLeader): An AutoCAD Leader

    ### Returns
    - `Leader` (Rhino.Geometry.Leader): A Rhino Leader

    ### Remarks
    Legacy Leader objects are automatically converted to MLeader format internally.
  </Col>
  <Col sticky>
    ```csharp
    // Example: Extract leader endpoint
    //
    // AutoCAD Leader Param
    //     → From AutoCAD Leader [Leader]
    //         → Deconstruct Leader
    //         → [ArrowPoint]: Leader tip location
    ```
  </Col>
</Row>
