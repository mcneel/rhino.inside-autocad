export const metadata = {
  title: 'Document - Rhino.Inside.AutoCAD',
  description: 'Components for working with AutoCAD documents in Grasshopper',
}

# Document

Components for accessing and working with AutoCAD documents. These components provide access to open drawings, document properties, and object identification within the AutoCAD database.

```csharp
// Namespace: Rhino.Inside.AutoCAD.GrasshopperLibrary
using Rhino.Inside.AutoCAD.Interop;
```

---

## GetAutocadDocumentsComponent {{ tag: 'List<AutocadDocument>', label: 'Document' }}

<Row>
  <Col>
    Returns the AutoCAD documents currently open in the AutoCAD session.

    ### Parameters
    *No input parameters required*

    ### Returns
    - `Documents` (List&lt;AutocadDocument&gt;): All open AutoCAD documents
    - `Active Document` (AutocadDocument): The currently active AutoCAD document

    ### Remarks
    This component is typically the starting point for most Grasshopper definitions that interact with AutoCAD. The active document is the one currently visible in the AutoCAD editor.
  </Col>
  <Col sticky>
    ```csharp
    // Example: Get all open documents
    using Rhino.Inside.AutoCAD.Interop;

    // In Grasshopper, drag the component to canvas
    // No inputs required

    // Outputs:
    // Documents → List of all open .dwg files
    // ActiveDoc → The currently focused document

    // Typical workflow:
    // GetAutocadDocuments → AutocadDocument → GetLayers
    //                    → AutocadDocument → GetBlocks
    ```
  </Col>
</Row>

---

## AutocadDocumentComponent {{ tag: 'Properties', label: 'Document' }}

<Row>
  <Col>
    Gets information from an AutoCAD Document.

    ### Parameters
    - `Document` (AutocadDocument): An AutoCAD Document

    ### Returns
    - `File Name` (String): The name of the AutoCAD file
    - `File Path` (String): The full file path of the AutoCAD file
    - `Read Only` (Boolean): Whether the file is read-only
    - `Active` (Boolean): Whether the document is currently active

    ### Remarks
    Use this component to extract document metadata for conditional logic or file management workflows.
  </Col>
  <Col sticky>
    ```csharp
    // Example: Check if document is read-only before baking
    using Rhino.Inside.AutoCAD.Interop;

    // Connect Document from GetAutocadDocuments
    //
    // Workflow:
    // GetAutocadDocuments [ActiveDoc]
    //     → AutocadDocument [ReadOnly]
    //         → Gate component (block if true)
    //             → Bake component

    // Output examples:
    // FileName: "Site_Plan.dwg"
    // FilePath: "C:\\Projects\\Site_Plan.dwg"
    // ReadOnly: false
    // Active: true
    ```
  </Col>
</Row>

---

## AutocadObjectIdComponent {{ tag: 'ObjectId', label: 'Document' }}

<Row>
  <Col>
    Extracts information from an AutoCAD ObjectId, which uniquely identifies objects within an AutoCAD database.

    ### Parameters
    - `ObjectId` (AutocadObjectId): An AutoCAD ObjectId

    ### Returns
    - `Handle` (String): The persistent handle of the object
    - `IsValid` (Boolean): Whether the ObjectId is valid
    - `IsNull` (Boolean): Whether the ObjectId is null

    ### Remarks
    ObjectIds are the primary way to track and reference AutoCAD entities. The Handle is persistent across sessions, while the ObjectId may change.

    ### See Also
    - `GetAutocadByIdComponent` - Retrieve objects by ObjectId
  </Col>
  <Col sticky>
    ```csharp
    // Example: Store handles for later retrieval
    using Autodesk.AutoCAD.DatabaseServices;

    // After baking, store the handles:
    // Bake [ObjectIds] → AutocadObjectId [Handle]
    //                  → Panel (store handle strings)

    // Handles persist across AutoCAD sessions
    // Format: "1A2B3C" (hexadecimal string)

    // Use handles to:
    // - Track baked geometry
    // - Create object relationships
    // - Implement update/replace workflows
    ```
  </Col>
</Row>

---

## GetAutocadByIdComponent {{ tag: 'Entity', label: 'Document' }}

<Row>
  <Col>
    Retrieves an AutoCAD object from the database using its ObjectId.

    ### Parameters
    - `Document` (AutocadDocument): An AutoCAD Document
    - `ObjectId` (AutocadObjectId): The ObjectId of the object to retrieve

    ### Returns
    - `Object` (Entity): The AutoCAD entity

    ### Remarks
    Use this component to retrieve previously baked objects for modification or analysis. Combined with stored ObjectIds, this enables update-in-place workflows.

    ### Exceptions
    Returns null if the object has been deleted or the ObjectId is invalid.
  </Col>
  <Col sticky>
    ```csharp
    // Example: Retrieve a previously baked object
    using Autodesk.AutoCAD.DatabaseServices;
    using Rhino.Inside.AutoCAD.Interop;

    // Workflow for updating existing geometry:
    // 1. Store ObjectIds from initial bake
    // 2. Later, retrieve the objects:
    //
    // Panel [stored ObjectId]
    //     → GetAutocadById [Object]
    //         → From AutoCAD Curve
    //             → Modify in Grasshopper
    //                 → To AutoCAD Curve
    //                     → Bake (replace)
    ```
  </Col>
</Row>
